"use strict";(globalThis.webpackChunkjira_assistant=globalThis.webpackChunkjira_assistant||[]).push([[88],{3088:(e,t,s)=>{s.r(t),s.d(t,{default:()=>D});var i=s(9584),a=s(5432),o=s(4896),r=s(1720),n=s(9640),l=s(8356),d=s(3720),c=s(9108),h=s(7884);class p extends i.PureComponent{constructor(e){super(e),this.saveName=()=>{this.setState({isEditMode:!1});const{value:e,icon:t}=this.state;this.props.onChange(e,t)},this.onChange=e=>this.setState({value:e}),this.onIconChange=e=>this.setState({icon:e}),this.cancelEdit=()=>this.setState({isEditMode:!1,value:this.props.value,icon:this.props.icon}),this.showIcons=e=>this.op.show(e),this.setRef=e=>this.op=e,this.state=this.getState(e)}UNSAFE_componentWillReceiveProps(e){this.setState(this.getState(e))}getState(e){let{value:t,icon:s}=e;return s||(s="fa-tachometer"),t||(t="Default"),{value:t,icon:s}}render(){const{value:e,icon:t,isEditMode:s}=this.state;return s?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"p-inputgroup dashboard-name-edit",children:[(0,h.jsx)(n.q,{icon:`fa ${t}`,onClick:this.showIcons}),(0,h.jsx)(l.c,{value:e,maxLength:18,onChange:this.onChange}),(0,h.jsx)(n.q,{icon:"fa fa-check",type:"success",onClick:this.saveName,disabled:!e||e.length<=2}),(0,h.jsx)(n.q,{icon:"fa fa-undo",onClick:this.cancelEdit})]}),(0,h.jsx)(d.W,{ref:this.setRef,children:(0,h.jsxs)("div",{className:"dashboard-icons",children:[c.o.map(((e,t)=>(0,h.jsx)("div",{className:"d-icon",onClick:()=>this.onIconChange(e),children:(0,h.jsx)("span",{className:e})},t))),(0,h.jsx)("div",{className:"clear-fix"})]})})]}):(0,h.jsxs)("div",{className:"dashboard-name",title:"Click to edit the name or change the icon",onClick:()=>this.setState({isEditMode:!0}),children:[(0,h.jsx)("span",{className:`board-icon fa ${t}`}),(0,h.jsx)("span",{className:"lev-1",children:"Dashboards"}),(0,h.jsx)("i",{className:"fa fa-arrow-right"}),(0,h.jsx)("span",{className:"lev-2",children:e}),(0,h.jsx)("i",{className:"fa fa-edit"})]})}}const u=p;var g=s(5068);class f extends i.PureComponent{constructor(e){super(e),this.nameChanged=(e,t)=>{const{index:s,config:i}=this.state;i.name=e,i.icon=t,this.$dashboard.saveDashboardInfo(s,i,!0)},this.showContext=e=>(0,g._A)(e,this.contextMenu),(0,o.uU)(this,"DashboardService"),this.state=this.getStateDetails(e)}UNSAFE_componentWillReceiveProps(e){this.setState(this.getStateDetails(e))}getStateDetails(e){const{config:t,index:s}=e,i=[{label:"Create dashboard",icon:"fa fa-plus",command:()=>this.$dashboard.createDashboard(this.state.config)},{label:"Delete dashboard",icon:"fa fa-trash",command:()=>this.deleteDashboard(),disabled:0===s}];if(!this.props.isQuickView){const e={label:"Show in tabs",icon:t.isTabView?"fa fa-check-square":"fa fa-square",command:()=>this.setAsTabView(e)},s={label:"Set as quick view",icon:t.isQuickView?"fa fa-check-square":"fa fa-square",disabled:t.isQuickView,command:()=>this.setAsQuickView(s)};i.push(e),i.push(s)}return this.contextMenu=i,{config:t,index:s}}async deleteDashboard(){await this.$dashboard.deleteDashboard(this.state.index),this.props.navigate(`/${this.props.userId}/dashboard/0`)}async setAsQuickView(e){e.disabled=!0,e.icon="fa fa-check-square",this.contextMenu=[...this.contextMenu];const t=await this.$dashboard.setAsQuickView(this.state.config,this.state.index);this.setState({config:t})}async setAsTabView(e){const{config:t,index:s}=this.state,i=await this.$dashboard.setAsTabView(t,s);e.icon=i.isTabView?"fa fa-check-square":"fa fa-square",this.contextMenu=[...this.contextMenu],this.setState({config:i}),this.props.tabViewChanged(i.isTabView)}render(){const{config:{icon:e,name:t}}=this.state;return(0,h.jsxs)("div",{className:"page-header",children:[(0,h.jsx)("div",{className:"float-start",children:(0,h.jsx)(u,{icon:e,value:t,onChange:this.nameChanged})}),(0,h.jsxs)("div",{className:"float-end",children:[(0,h.jsx)(n.q,{text:!0,type:"success",icon:"fa fa-cubes",label:"Add gadgets",onClick:this.props.onShowGadgets}),!this.props.isQuickView&&(0,h.jsx)(n.q,{text:!0,icon:"fa fa-wrench",onClick:this.showContext})]})]})}}const m=f;var y=s(4324);function v({gadgets:e,...t}){return e?e.map((e=>(0,h.jsx)(w,{gadget:e,...t},e.id))):(0,h.jsx)(n.c1,{})}function w({gadget:e,addedGadgets:t,addGadget:s,removeGadget:a}){const o=t.some((t=>t.name===e.id)),{id:r}=e,l=i.useCallback((()=>s(r)),[r,s]),d=i.useCallback((()=>a(r)),[r,a]);return(0,h.jsxs)("div",{className:"gadget-info",children:[(0,h.jsxs)("div",{className:"details",children:[(0,h.jsx)("span",{className:"name",children:e.name}),(0,h.jsx)("span",{className:"desc",children:e.details})]}),(0,h.jsxs)("div",{className:"controls",children:[!o&&(0,h.jsx)(n.q,{type:"primary",icon:"fa fa-plus",label:"Add",disabled:e.isOld,onClick:l}),o&&(0,h.jsx)(n.q,{type:"danger",icon:"fa fa-times",label:"Remove",onClick:d})]})]})}const b=function({show:e,onHide:t,...s}){const[a,o]=i.useState(),l=e&&!a;return i.useEffect((()=>{l&&async function(){const{$report:e}=(0,y.uU)("ReportService"),t=(await e.getReportsList()).filter((e=>"pivot"!==e.reportType));if(null===t||void 0===t||!t.length)return r.Ci;const s=t.map((e=>({id:`${e.advanced?"AR":e.isNew?"CR":"SQ"}:${e.id}:${e.queryName}`,icon:"fa fa-filter",name:e.queryName,isOld:!(e.isNew||e.advanced),details:e.advanced?"<no details available>":`${e.outputCount} columns displayed in table format${e.isNew?" with interactive option to sort and group based on columns.":" (deprecated, not allowed to add to dashboard)"}`})));return[...r.Ci,...s]}().then(o)}),[l,o]),(0,h.jsx)("div",{className:"add-gadget-container "+(e?"open":"closed"),children:(0,h.jsxs)("div",{className:"gadget-block",children:[(0,h.jsxs)("div",{className:"header",children:[(0,h.jsx)(n.q,{className:"close-icon",icon:"fa fa-times",onClick:t}),(0,h.jsx)("h2",{className:"title",children:"Add a Gadget"})]}),(0,h.jsx)("div",{className:"gadgets-list",children:(0,h.jsx)(v,{gadgets:a,...s})})]})})};var k=s(444),x=s(432),S=s(1296),C=s(1144);class j extends i.PureComponent{constructor(e){super(e),this.tabViewChanged=e=>this.setState({isTabView:e}),this.addGadget=(e,t)=>{let{currentBoard:s}=this.state;s={...s},s.widgets=s.widgets.concat({name:e,settings:t||{}}),this.setState({currentBoard:s})},this.removeGadget=e=>{let{currentBoard:t}=this.state;t={...t};const s=[...t.widgets];s.removeAll((t=>t.name===e)),t.widgets=s,this.setState({currentBoard:t})},this.saveDashboardInfo=()=>{const{dashboardIndex:e,currentBoard:t}=this.state;this.$dashboard.saveDashboardInfo(e,t)},this.widgetAction=(e,t,s)=>{switch(e.type){case r.s5.AddWorklog:this.worklogItem=e.data,this.setState({showWorklogPopup:!0});break;case r.s5.RemoveGadget:let{currentBoard:i}=this.state;i={...i};const a=[...i.widgets];i.widgets=a,a.splice(s,1),this.setState({currentBoard:i},this.saveDashboardInfo),this.emitToChildren(e,s);break;case r.s5.SettingsChanged:t.settings=e.data,this.saveDashboardInfo();break;default:this.emitToChildren(e,s)}},this.gadgetReordered=e=>{let{currentBoard:t}=this.state;t={...t,widgets:e},this.setState({currentBoard:t},this.saveDashboardInfo)},this.getControls=(e,t,{draggable:{dragRef:s}={},droppable:i}={})=>{let{name:o}=e;const{settings:r}=e,n=this.state.isTabView,l=o.split(":");l.length>1&&(o=l[0],l.splice(0,1));let d=this.gadgetsList[o];d||(d={title:"Gadget Unavailable",control:x.cp});let c=null;d.getProps&&(c=d.getProps(r,l));const p={key:`${o}_${l[0]}`,gadgetType:o,tabLayout:n,index:t,model:e,settings:r,isGadget:!0,layout:this.state.currentBoard.layout,onAction:this.widgetAction,...c},u=d.control;if(n){var g;let e=(null===(g=c)||void 0===g?void 0:g.title)||d.title;return e||(e="function"===typeof u.getTitle?u.getTitle(p):"Unknown Gadget"),(0,h.jsx)(a.TabPanel,{header:e,children:(0,h.jsx)(u,{...p})},o)}return(0,h.jsx)(u,{...p,draggableHandle:s,dropProps:i})},this.onShowGadgets=()=>this.setState({showGadgetPanel:!0}),this.hideGadgetDialog=()=>{this.setState({showGadgetPanel:!1}),this.saveDashboardInfo()},this.worklogAdded=e=>{this.emitToChildren(e),this.hideWorklog()},this.hideWorklog=()=>this.setState({showWorklogPopup:!1}),(0,o.uU)(this,"DashboardService","SessionService","ReportService","CacheService"),this.rapidViews=this.$session.CurrentUser.rapidViews||[];const{match:{params:t}}=e;this.isQuickView=this.$session.isQuickView,this.state=this.loadDashboard(parseInt(t.index||0)),this.gadgetsList=function(){const e={myOpenTickets:{title:"My open tickets",control:r.OY},bookmarksList:{title:"My Bookmarks",control:r.Uj},dateWiseWorklog:{title:"Daywise worklog",control:r.Kg},worklogBarChart:{title:"Worklog Bar Chart",control:r.Ws},teamWorklogReport:{title:"Team Daywise Worklog",control:r.E7},pendingWorklog:{title:"Worklog - [Pending upload]",control:r.Cm},ticketWiseWorklog:{title:"Ticketwise worklog",control:r.MX},sWiseTSpent:{title:"Status Wise Time Spent",control:r.g9},myFilters:{title:"My reports",control:r.W},agendaDay:{title:"Calendar",control:r.Yf,getProps:()=>({viewMode:"timeGridDay"})},agendaWeek:{title:"Calendar",control:r.Yf,getProps:()=>({viewMode:"timeGridWeek"})},listDay:{title:"Calendar",control:r.Yf,getProps:()=>({viewMode:"listDay"})},listWeek:{title:"Calendar",control:r.Yf,getProps:()=>({viewMode:"listWeek"})},listMonth:{title:"Calendar",control:r.Yf,getProps:()=>({viewMode:"listMonth"})},CR:{title:"Custom report",control:S.c,getProps:(e,t)=>({reportId:parseInt(t[0]),title:t[1]})},AR:{title:"Advanced report",control:C.c,getProps:(e,t)=>({reportId:parseInt(t[0]),title:t[1]})}};return e.myBookmarks=e.bookmarksList,e.dtWiseWL=e.dateWiseWorklog,e.pendingWL=e.pendingWorklog,e}()}UNSAFE_componentWillReceiveProps(e){const t=parseInt(e.match.params.index||0);t!==this.state.dashboardIndex&&this.setState(this.loadDashboard(t))}loadDashboard(e){const t=this.$session.CurrentUser.dashboards;e>=t.length&&(e=0);const s=t[e];return{dashboardIndex:e,currentBoard:s,isTabView:this.isQuickView||s.isTabView}}emitToChildren(e,t){x.MV.emit("change",e,t)}getGadgets(e){return e&&e.length?this.state.isTabView?(0,h.jsx)(a.TabView,{className:"no-padding tab-gadgets",children:e.map(this.getControls)}):(0,h.jsx)(n.T2,{className:"dashboard-gadgets",useDragRef:!0,useDropRef:!0,items:e,defaultItemType:"gadget",onChange:this.gadgetReordered,children:this.getControls}):null}render(){const{currentBoard:{widgets:e},dashboardIndex:t,currentBoard:s,showGadgetPanel:i,showWorklogPopup:a}=this.state;return(0,h.jsxs)(h.Fragment,{children:[!this.isQuickView&&(0,h.jsx)(b,{show:i,onHide:this.hideGadgetDialog,addedGadgets:e,addGadget:this.addGadget,removeGadget:this.removeGadget}),(0,h.jsxs)("div",{className:"page-container dashboard-container",children:[!this.isQuickView&&(0,h.jsx)(m,{...this.props,config:s,index:t,userId:this.$session.userId,onShowGadgets:this.onShowGadgets,tabViewChanged:this.tabViewChanged,isQuickView:this.isQuickView}),this.getGadgets(e),(!e||0===e.length)&&(0,h.jsx)("div",{className:"no-widget-div",children:'You haven\'t added any gadgets to this dashboard. Click on "Add gadgets" button above to start adding a cool one and personalize your experience.'})]}),a&&(0,h.jsx)(k.c,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog})]})}}const D=j},1296:(e,t,s)=>{s.d(t,{c:()=>b});s(9584);var i=s(5240),a=s(9640),o=s(2960),r=s(432),n=s(4896),l=s(1916),d=s(5244),c=s(416);async function h(e,t){if(!e)return{};const s=(0,n.WI)("JiraService"),i=e.fields.map((e=>e.field)),a=await s.searchTickets(e.jql,i),o={utils:t},r=e.fields.filter((e=>!e.hide)).map(p.bind(o));o.fieldWithExpr=r.filter((e=>!!e.ast));const d=a.map(u.bind(o));if(o.hasWorklogs){const e=o.usersObj,t=Object.keys(e).map((t=>({field:t,displayText:e[t].displayName,type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:l.yS,props:{format:!1}})));t.push({field:"totalWorklog",displayText:"Total Log Work",type:"seconds",groupText:"Log Work",allowGrouping:!1,viewComponent:l.yS,props:{format:!1}});const s=r.findIndex((({field:e})=>"worklog"===e));r.splice(s,1,...t)}return{isLoading:!1,reportData:d,columnList:r,settings:e.settings}}function p(e){const{id:t,field:s,name:i,header:a=i,type:o,isArray:r,expr:n}=e,h={id:t,field:s,displayText:a,type:o,props:{},allowSorting:!r,allowGrouping:"summary"!==s&&"description"!==s};return n?(h.ast=(0,d._h)(n),h.exprField=s,h.field=t,h.viewComponent=l.o3):h.viewComponent=function(e,t,s){const{props:i}=t;switch(e){case"issuekey":return l.MB;case"epicLink":return i.hideContext=!0,l.MB;case"project":return t.fieldKey=`${t.field}.name`,l.kP;case"user":return t.fieldKey=`${t.field}.displayName`,l.W8;case"comment":return t.allowSorting=!1,l.od;case"issuelinks":return l.SG;case"seconds":return l.yS;case"workratio":return i.converter=function(e){return-1===e?null:e},l.yS;case"timetracking":return l.AT;case"parent":return t.fieldKey=`${t.field}.key`,l.kz;case"progress":case"aggregateprogress":return t.fieldKey=`${t.field}.percent`,l.q0;case"sprint":return l._w;case"attachment":return i.hrefProp="content",i.iconClass="fa-paperclip",i.tagProp="filename",l._w;case"component":return i.titleProp="description",l._w;case"version":return i.titleProp="releaseDate",l._w;case"option":return t.fieldKey=`${t.field}.value`,i.tagProp="value",l._w;case"votes":return t.fieldKey=`${t.field}.votes`,i.tagProp="votes",i.hideZero=!0,l._w;case"watches":return t.fieldKey=`${t.field}.watchCount`,i.tagProp="watchCount",i.hideZero=!0,l._w;case"date":case"datetime":return l.Yu;case"issuetype":case"status":case"priority":case"resolution":return t.fieldKey=`${t.field}.name`,l.Sk;case"epicStatus":return i.textField="value",i.iconField="",t.fieldKey=`${t.field}.value`,l.Sk;case"string":return s?(i.tagProp="",l._w):null;case"number":return l.o3;case"option-with-child":return c.c;default:return t.allowSorting=!1,t.allowGrouping=!1,l.o3}}("issuekey"===s?"issuekey":o,h,r),h.allowSorting||(h.allowGrouping=!1),h.allowGrouping&&function(e){const t=[{type:"check",label:"Issue count",prop:"showGroupCount",value:!0},{separator:!0}];switch(e.type){default:return;case"issuetype":case"status":case"priority":case"resolution":t.splice(1,1);break;case"string":t.push({type:"radio",label:"Show value",prop:"valueType",value:"value",default:!0}),t.push({type:"radio",label:"Show count",prop:"valueType",value:"count"}),t.push({type:"radio",label:"Distinct count",prop:"valueType",value:"distinct"});break;case"user":t[1]={type:"check",label:"Show Image",prop:"showImage"},t.push({separator:!0}),t.push({type:"radio",label:"Show name",prop:"valueType",value:"name",default:!0}),t.push({type:"radio",label:"Show email id",prop:"valueType",value:"email"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"project":t.push({type:"radio",label:"Show name",prop:"valueType",value:"name"}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"parent":t[1]={type:"check",label:"Show status",prop:"showStatus",default:!0},t.push({separator:!0}),t.push({type:"radio",label:"Show key",prop:"valueType",value:"key",default:!0}),t.push({type:"radio",label:"Show summary",prop:"valueType",value:"summary"}),t.push({type:"radio",label:"Show both",prop:"valueType",value:"both"});break;case"date":case"datetime":t.push({type:"radio",label:"Friendly date",prop:"funcType",value:"friendly"}),t.push({type:"radio",label:"Group by year",prop:"funcType",value:"yyyy"}),t.push({type:"radio",label:"Group by month",prop:"funcType",value:"MMMM"}),t.push({type:"radio",label:"Group by both",prop:"funcType",value:"yyyy-MM (MMMM)",default:!0}),t.push({type:"radio",label:"Group by date",prop:"funcType",value:"yyyy-MM-dd"});break;case"number":case"seconds":t.push({type:"radio",label:"Group by field",prop:"funcType",value:"",default:!0}),t.push({type:"radio",label:"Sum of field",prop:"funcType",value:"sum"}),t.push({type:"radio",label:"Avg of field",prop:"funcType",value:"avg"}),t.push({type:"radio",label:"Count having value",prop:"funcType",value:"count"})}e.groupOptions=t}(h),h}function u(e){const t=e.fields;return t.issuekey=e.key,t.id=e.id,g.call(this,t),function(e){if(!e.comment)return;e.comment=e.comment.comments}(t),f.call(this,t),t}function g(e){if(!e.worklog)return;if(e.worklog=e.worklog.worklogs,!e.worklog.length)return void delete e.worklog;this.hasWorklogs=!0;const t=this.usersObj||{};this.usersObj=t;for(const s of e.worklog){const{author:i,timeSpentSeconds:a}=s,{accountId:o,emailAddress:r}=i,n=r||o;t[n]||(t[n]=i),e[n]=(e[n]||0)+a,e.totalWorklog=(e.totalWorklog||0)+a}}function f(e){if(this.fieldWithExpr.length)for(const s of this.fieldWithExpr)if("string"!==typeof s.ast)try{e[s.id]=m(s.ast,e[s.exprField],{Fields:e,Utils:this.utils})}catch(t){e[s.id]=`Error: ${(null===t||void 0===t?void 0:t.message)||t}`}else e[s.id]=s.ast}function m(e,t,s){return function(e){if(e instanceof Date)return this.utils.formatDateTime(e);if("object"===typeof e&&!Array.isArray(e)){const t=Object.keys(e);return t.includes("type")&&t.includes("key")&&t.includes("props")?e:JSON.stringify(e)}return e}((0,d.EP)(e,{this:t,...s,JSON:JSON,parseInt:parseInt,parseFloat:parseFloat,isNaN:isNaN,Math:Math,Number:Number,Date:Date,func:y.bind(this,s)}))}function y(e,t,s,i){if(!t)throw Error("No expression is passed to func. First argument should be an expression");if(s&&!Array.isArray(s))throw Error("Second argument should be an array of argument names used in expression");if(i&&"object"!==typeof i)throw Error("Third argument should be an object containing all the variables from current scope to be available for expression");const a=(0,d._h)(t);return i={...e,...i},function(){let e=arguments;return e=s.reduce(((t,s,i)=>(t[s]=e[i],t)),i),m(a,this,e)}}var v=s(7884);class w extends r.cp{constructor(e){const{query:t}=e;super(e,(null===t||void 0===t?void 0:t.queryName)||"Custom report viewer","fa-clock"),this.toggleGroupOptions=()=>this.setState({hideGroups:!this.state.hideGroups}),this.refreshData=()=>this.loadData(this.props.query||this.state.query),this.loadData=async e=>{this.setState({isLoading:!0,hasError:!1});try{this.setState(await h(e,{formatDate:this.$userutils.formatDate,formatTime:this.$userutils.formatTime,formatDateTime:this.$userutils.formatDateTime,formatSecs:this.$utils.formatSecs,formatMS:this.$utils.formatTs,showAsLink:e=>(0,v.jsx)(o.c,{href:this.$userutils.getTicketUrl(e),children:e})}))}catch(t){this.setState({isLoading:!1,hasError:!0})}},this.tableSettingsChanged=e=>{this.settings={...this.settings,...e},this.isGadget?(this.saveSettings(),this.setState({settings:e})):this.props.settingsChanged(e)},(0,n.uU)(this,"AnalyticsService","ReportService","JiraService","UtilsService","UserUtilsService"),this.state.isLoading=!0,this.state.hideGroups=this.isGadget}componentDidMount(){this.initWithProps(this.props)}renderCustomActions(e){return e?(0,v.jsx)(a.q,{type:"success",title:"Click to toggle group options",icon:this.state.hideGroups?"fa fa-toggle-off":"fa fa-toggle-on",onClick:this.toggleGroupOptions}):(0,v.jsx)(a.q,{type:"success",label:"Edit",title:"Click to edit the report",icon:"fa fa-edit",onClick:this.props.onEditClicked})}UNSAFE_componentWillReceiveProps(e){super.UNSAFE_componentWillReceiveProps(e),this.initWithProps(e)}initWithProps(e){const{query:t,reportId:s}=e;s?this.reportId!==s&&(this.reportId=s,this.loadReportDefinition(s)):t&&this.query!==t&&(this.query=t,this.loadReportData(t))}async loadReportDefinition(e){const t=await this.$report.getReportDefinition(e);this.title=(null===t||void 0===t?void 0:t.queryName)||"Custom report viewer",this.setState({query:t}),this.loadReportData(t)}loadReportData(e){this.settings={...e.settings,...this.settings},this.jql===e.jql&&this.fields===e.fields||(this.jql=e.jql,this.fields=e.fields,this.loadData(e))}render(){const{query:e}=this.props,{query:t=e}=this.state,{loading:s,reportData:a,columnList:o,settings:r,hasError:n,hideGroups:l}=this.state,{displayColumns:d,groupBy:c,groupFoldable:h,sortField:p,isDesc:u}=this.settings||r||{};return n?super.renderBase((0,v.jsx)("div",{className:"error-block",children:"Unable to load this report due to an error."})):s||!a?super.renderBase():super.renderBase((0,v.jsx)(i.c,{dataset:a,hideGroups:l,exportSheetName:t.queryName,columns:o,allowSorting:!0,onChange:this.tableSettingsChanged,displayColumns:d,groupBy:c,groupFoldable:h,sortField:p,isDesc:u,noRowsMessage:"No ticket details available"}))}}const b=w},1144:(e,t,s)=>{s.d(t,{c:()=>p});s(9584);var i=s(432),a=s(4324),o=s(9640),r=s(5068),n=s(4312),l=s(444),d=s(4568),c=s(7884);class h extends i.cp{constructor(e){super(e,"Advanced report viewer","fa-clock"),this.usersSelected=e=>{this.parameterEvent.onChange(this.parameterEvent.definition,e),this.parameterEvent=null,this.setState({showGroupsPopup:!1,groups:e})},this.refreshData=()=>{this.props.reportId>0?this.$report.getReportDefinition(this.props.reportId).then((e=>{this.setReportDefinition(e),this.$analytics.trackEvent("Advanced report viewed",d.HG.UserActions)})):this.state.definition&&(this.title=this.state.definition.queryName,this.$analytics.trackEvent("Advanced report viewed",d.HG.UserActions))},this.getApi=e=>this.viewer=e,this.worklogAdded=e=>{this.hideWorklog()},this.hideWorklog=()=>{this.setState({showWorklogPopup:!1})},(0,a.uU)(this,"ReportConfigService","AnalyticsService","ReportService"),this.viewer={},this.$reportConfig.configureViewer(),this.$reportConfig.parameters.removeAllListeners(),this.$reportConfig.parameters.on("click",this.parameterClicked.bind(this)),this.$reportConfig.eventPipe.on("addWorklog",this.addWorklog.bind(this));const{definition:t}=e;this.state.definition=t}componentDidMount(){super.componentDidMount(),this.refreshData()}UNSAFE_componentWillReceiveProps(e){e.definition?this.setReportDefinition(e.definition):e.reportId?this.refreshData():this.setReportDefinition({})}addWorklog(e){this.isGadget?super.addWorklog(e):(this.worklogItem=e,this.setState({showWorklogPopup:!0}))}parameterClicked(e){this.parameterEvent=e,this.setState({showGroupsPopup:!0})}setReportDefinition(e){e&&e.queryName&&(this.title=e.queryName),this.setState({definition:e})}renderCustomActions(){return(0,c.jsxs)(c.Fragment,{children:[!this.isGadget&&(0,c.jsx)(o.q,{text:!0,icon:this.isFullScreen?"fa fa-compress":"fa fa-expand",onClick:this.toggleFullScreen,title:"Toggle full screen"}),this.viewer.canShowParams&&(0,c.jsx)(o.q,{text:!0,icon:"fa fa-plus-circle",onClick:this.viewer.showParameters,title:"Change report params"}),!this.isGadget&&(0,c.jsx)(o.q,{text:!0,icon:"fa fa-edit",onClick:this.props.onCancelView,title:"Edit report"})]})}render(){const{state:{definition:e,showGroupsPopup:t,groups:s,showWorklogPopup:i}}=this;return super.renderBase((0,c.jsxs)(c.Fragment,{children:[e&&(0,c.jsx)(r.Sg,{api:this.getApi,definition:e}),t&&(0,c.jsx)(n.c,{groups:s,onHide:this.usersSelected}),i&&(0,c.jsx)(l.c,{worklog:this.worklogItem,onDone:this.worklogAdded,onHide:this.hideWorklog})]}))}}const p=h}}]);